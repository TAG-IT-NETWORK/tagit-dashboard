specVersion: 0.0.5
schema:
  file: ./schema.graphql
dataSources:
  # TAGITCore - Asset lifecycle events
  # NIST CSF 2.0 Deployment - Jan 6, 2026
  - kind: ethereum
    name: TAGITCore
    network: optimism-sepolia
    source:
      address: "0x88D2b62FD388b2d7e3df5fc666D68Ac7c7ca02Fe"
      abi: TAGITCore
      startBlock: 37959312
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.7
      language: wasm/assemblyscript
      entities:
        - Asset
        - StateChange
        - Transfer
        - Flag
      abis:
        - name: TAGITCore
          file: ./abis/TAGITCore.json
      eventHandlers:
        - event: Transfer(indexed address,indexed address,indexed uint256)
          handler: handleTransfer
        - event: StateChanged(indexed uint256,uint8,uint8)
          handler: handleStateChanged
        - event: AssetFlagged(indexed uint256,indexed address,string)
          handler: handleAssetFlagged
        - event: AssetResolved(indexed uint256,indexed address,uint8)
          handler: handleAssetResolved
      file: ./src/mappings/tagit-core.ts

  # TAGITAccess - Capability events
  - kind: ethereum
    name: TAGITAccess
    network: optimism-sepolia
    source:
      address: "0x8611fE68f6E37238b0af84c5f2Ac2dc9012138a9"
      abi: TAGITAccess
      startBlock: 37959312
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.7
      language: wasm/assemblyscript
      entities:
        - User
        - CapabilityGrant
      abis:
        - name: TAGITAccess
          file: ./abis/TAGITAccess.json
      eventHandlers:
        - event: CapabilityGranted(indexed address,indexed bytes32,address)
          handler: handleCapabilityGranted
        - event: CapabilityRevoked(indexed address,indexed bytes32,address)
          handler: handleCapabilityRevoked
      file: ./src/mappings/tagit-access.ts

  # IdentityBadge - Badge events
  - kind: ethereum
    name: IdentityBadge
    network: optimism-sepolia
    source:
      address: "0x26F2E8b84664EF1ef8554e15777E8Ec6611256A6"
      abi: IdentityBadge
      startBlock: 37959311
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.7
      language: wasm/assemblyscript
      entities:
        - User
        - BadgeGrant
      abis:
        - name: IdentityBadge
          file: ./abis/IdentityBadge.json
      eventHandlers:
        - event: BadgeGranted(indexed address,indexed uint256,address)
          handler: handleBadgeGranted
        - event: BadgeRevoked(indexed address,indexed uint256,address)
          handler: handleBadgeRevoked
      file: ./src/mappings/identity-badge.ts
