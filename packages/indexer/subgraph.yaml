specVersion: 0.0.5
schema:
  file: ./schema.graphql
dataSources:
  # TAGITCore - Asset lifecycle events
  # NIST CSF 2.0 Deployment - Jan 6, 2026
  - kind: ethereum
    name: TAGITCore
    network: optimism-sepolia
    source:
      address: "0x6fFFa92efb419E812d5c9C9D0c1B1a0f5c6fFd1C"
      abi: TAGITCore
      startBlock: 37959312
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.7
      language: wasm/assemblyscript
      entities:
        - Asset
        - StateChange
        - Transfer
        - Flag
      abis:
        - name: TAGITCore
          file: ./abis/TAGITCore.json
      eventHandlers:
        - event: Transfer(indexed address,indexed address,indexed uint256)
          handler: handleTransfer
        - event: StateChanged(indexed uint256,uint8,uint8)
          handler: handleStateChanged
        - event: AssetFlagged(indexed uint256,indexed address,string)
          handler: handleAssetFlagged
        - event: AssetResolved(indexed uint256,indexed address,uint8)
          handler: handleAssetResolved
      file: ./src/mappings/tagit-core.ts

  # TAGITAccess - Capability events
  - kind: ethereum
    name: TAGITAccess
    network: optimism-sepolia
    source:
      address: "0x4609a869a813E7E596bF5Bf5cBC08F8092Ce6340"
      abi: TAGITAccess
      startBlock: 37959312
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.7
      language: wasm/assemblyscript
      entities:
        - User
        - CapabilityGrant
      abis:
        - name: TAGITAccess
          file: ./abis/TAGITAccess.json
      eventHandlers:
        - event: CapabilityGranted(indexed address,indexed bytes32,address)
          handler: handleCapabilityGranted
        - event: CapabilityRevoked(indexed address,indexed bytes32,address)
          handler: handleCapabilityRevoked
      file: ./src/mappings/tagit-access.ts

  # IdentityBadge - Badge events
  - kind: ethereum
    name: IdentityBadge
    network: optimism-sepolia
    source:
      address: "0x26D0B3B5FF2061fB38ce1aA66433a8F4439e46a8"
      abi: IdentityBadge
      startBlock: 37959311
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.7
      language: wasm/assemblyscript
      entities:
        - User
        - BadgeGrant
      abis:
        - name: IdentityBadge
          file: ./abis/IdentityBadge.json
      eventHandlers:
        - event: BadgeGranted(indexed address,indexed uint256,address)
          handler: handleBadgeGranted
        - event: BadgeRevoked(indexed address,indexed uint256,address)
          handler: handleBadgeRevoked
      file: ./src/mappings/identity-badge.ts
